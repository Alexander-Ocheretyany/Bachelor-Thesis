echo "Script has been started"

echo "Propagate files..."
Copy-Item 'Input.txt' -Destination '01-Pop(200)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Input.txt' -Destination '01-Pop(200)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Input.txt' -Destination '01-Pop(200)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Input.txt' -Destination '01-Pop(200)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Input.txt' -Destination '01-Pop(200)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Input.txt' -Destination '01-Pop(200)/06 - Best, no transfer' -Recurse -force

Copy-Item 'Input_VC_IS.txt' -Destination '01-Pop(200)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '01-Pop(200)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '01-Pop(200)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '01-Pop(200)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '01-Pop(200)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '01-Pop(200)/06 - Best, no transfer' -Recurse -force

Copy-Item 'GA.exe' -Destination '01-Pop(200)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'GA.exe' -Destination '01-Pop(200)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'GA.exe' -Destination '01-Pop(200)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'GA.exe' -Destination '01-Pop(200)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'GA.exe' -Destination '01-Pop(200)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'GA.exe' -Destination '01-Pop(200)/06 - Best, no transfer' -Recurse -force

Copy-Item 'Parser.exe' -Destination '01-Pop(200)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '01-Pop(200)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '01-Pop(200)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Parser.exe' -Destination '01-Pop(200)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '01-Pop(200)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '01-Pop(200)/06 - Best, no transfer' -Recurse -force



Copy-Item 'Input.txt' -Destination '02-Pop(100)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Input.txt' -Destination '02-Pop(100)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Input.txt' -Destination '02-Pop(100)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Input.txt' -Destination '02-Pop(100)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Input.txt' -Destination '02-Pop(100)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Input.txt' -Destination '02-Pop(100)/06 - Best, no transfer' -Recurse -force

Copy-Item 'Input_VC_IS.txt' -Destination '02-Pop(100)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '02-Pop(100)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '02-Pop(100)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '02-Pop(100)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '02-Pop(100)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '02-Pop(100)/06 - Best, no transfer' -Recurse -force

Copy-Item 'GA.exe' -Destination '02-Pop(100)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'GA.exe' -Destination '02-Pop(100)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'GA.exe' -Destination '02-Pop(100)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'GA.exe' -Destination '02-Pop(100)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'GA.exe' -Destination '02-Pop(100)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'GA.exe' -Destination '02-Pop(100)/06 - Best, no transfer' -Recurse -force

Copy-Item 'Parser.exe' -Destination '02-Pop(100)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '02-Pop(100)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '02-Pop(100)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Parser.exe' -Destination '02-Pop(100)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '02-Pop(100)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '02-Pop(100)/06 - Best, no transfer' -Recurse -force



Copy-Item 'Input.txt' -Destination '03-Pop(60)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Input.txt' -Destination '03-Pop(60)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Input.txt' -Destination '03-Pop(60)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Input.txt' -Destination '03-Pop(60)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Input.txt' -Destination '03-Pop(60)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Input.txt' -Destination '03-Pop(60)/06 - Best, no transfer' -Recurse -force

Copy-Item 'Input_VC_IS.txt' -Destination '03-Pop(60)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '03-Pop(60)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '03-Pop(60)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '03-Pop(60)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '03-Pop(60)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Input_VC_IS.txt' -Destination '03-Pop(60)/06 - Best, no transfer' -Recurse -force

Copy-Item 'GA.exe' -Destination '03-Pop(60)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'GA.exe' -Destination '03-Pop(60)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'GA.exe' -Destination '03-Pop(60)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'GA.exe' -Destination '03-Pop(60)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'GA.exe' -Destination '03-Pop(60)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'GA.exe' -Destination '03-Pop(60)/06 - Best, no transfer' -Recurse -force

Copy-Item 'Parser.exe' -Destination '03-Pop(60)/01 - Kill parents and transfer 10%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '03-Pop(60)/02 - Kill parents and transfer 5%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '03-Pop(60)/03 - Kill parents, no transfer' -Recurse -force
Copy-Item 'Parser.exe' -Destination '03-Pop(60)/04 - Best and transfer 10%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '03-Pop(60)/05 - Best and transfer 5%' -Recurse -force
Copy-Item 'Parser.exe' -Destination '03-Pop(60)/06 - Best, no transfer' -Recurse -force
echo "Done!"


echo "Start GA for population of size 200"
cd '01-Pop(200)'

cd '01 - Kill parents and transfer 10%'
Start-Process GA
cd ..
cd '02 - Kill parents and transfer 5%'
Start-Process GA
cd ..
cd '03 - Kill parents, no transfer'
Start-Process GA
cd ..
cd '04 - Best and transfer 10%'
Start-Process GA
cd ..
cd '05 - Best and transfer 5%'
Start-Process GA
cd ..
cd '06 - Best, no transfer'
Start-Process GA
cd ..
echo "Running..."

$p = get-process GA
Wait-Process -Id $p.id
echo "Done!"

echo "Parsers are working..."
cd '01 - Kill parents and transfer 10%'
Start-Process Parser -Wait
cd ..
cd '02 - Kill parents and transfer 5%'
Start-Process Parser -Wait
cd ..
cd '03 - Kill parents, no transfer'
Start-Process Parser -Wait
cd ..
cd '04 - Best and transfer 10%'
Start-Process Parser -Wait
cd ..
cd '05 - Best and transfer 5%'
Start-Process Parser -Wait
cd ..
cd '06 - Best, no transfer'
Start-Process Parser -Wait
cd ..

New-Item -Name "Data" -ItemType "directory"

Move-Item -Path '01 - Kill parents and transfer 10%/Table.txt' -Destination 'Data/01 - Kill parents and transfer 10%.txt'
Move-Item -Path '02 - Kill parents and transfer 5%/Table.txt' -Destination 'Data/02 - Kill parents and transfer 5%.txt'
Move-Item -Path '03 - Kill parents, no transfer/Table.txt' -Destination 'Data/03 - Kill parents, no transfer.txt'
Move-Item -Path '04 - Best and transfer 10%/Table.txt' -Destination 'Data/04 - Best and transfer 10%.txt'
Move-Item -Path '05 - Best and transfer 5%/Table.txt' -Destination 'Data/05 - Best and transfer 5%.txt'
Move-Item -Path '06 - Best, no transfer/Table.txt' -Destination 'Data/06 - Best, no transfer.txt'
echo "Done!"

echo "Removing auxiliary files..."
Remove-Item '01 - Kill parents and transfer 10%/GA.exe'
Remove-Item '02 - Kill parents and transfer 5%/GA.exe'
Remove-Item '03 - Kill parents, no transfer/GA.exe'
Remove-Item '04 - Best and transfer 10%/GA.exe'
Remove-Item '05 - Best and transfer 5%/GA.exe'
Remove-Item '06 - Best, no transfer/GA.exe'

Remove-Item '01 - Kill parents and transfer 10%/Parser.exe'
Remove-Item '02 - Kill parents and transfer 5%/Parser.exe'
Remove-Item '03 - Kill parents, no transfer/Parser.exe'
Remove-Item '04 - Best and transfer 10%/Parser.exe'
Remove-Item '05 - Best and transfer 5%/Parser.exe'
Remove-Item '06 - Best, no transfer/Parser.exe'

Remove-Item '01 - Kill parents and transfer 10%/Input.txt'
Remove-Item '02 - Kill parents and transfer 5%/Input.txt'
Remove-Item '03 - Kill parents, no transfer/Input.txt'
Remove-Item '04 - Best and transfer 10%/Input.txt'
Remove-Item '05 - Best and transfer 5%/Input.txt'
Remove-Item '06 - Best, no transfer/Input.txt'

Remove-Item '01 - Kill parents and transfer 10%/Input_VC_IS.txt'
Remove-Item '02 - Kill parents and transfer 5%/Input_VC_IS.txt'
Remove-Item '03 - Kill parents, no transfer/Input_VC_IS.txt'
Remove-Item '04 - Best and transfer 10%/Input_VC_IS.txt'
Remove-Item '05 - Best and transfer 5%/Input_VC_IS.txt'
Remove-Item '06 - Best, no transfer/Input_VC_IS.txt'

cd ..
Rename-Item '01-Pop(200)' '01-Pop(200)+'
echo "Done!"



echo "Start GA for population of size 100"
cd '02-Pop(100)'

cd '01 - Kill parents and transfer 10%'
Start-Process GA
cd ..
cd '02 - Kill parents and transfer 5%'
Start-Process GA
cd ..
cd '03 - Kill parents, no transfer'
Start-Process GA
cd ..
cd '04 - Best and transfer 10%'
Start-Process GA
cd ..
cd '05 - Best and transfer 5%'
Start-Process GA
cd ..
cd '06 - Best, no transfer'
Start-Process GA
cd ..

echo "Running..."
$p = get-process GA
Wait-Process -Id $p.id
echo "Done!"

echo "Parsers are working..."
cd '01 - Kill parents and transfer 10%'
Start-Process Parser -Wait
cd ..
cd '02 - Kill parents and transfer 5%'
Start-Process Parser -Wait
cd ..
cd '03 - Kill parents, no transfer'
Start-Process Parser -Wait
cd ..
cd '04 - Best and transfer 10%'
Start-Process Parser -Wait
cd ..
cd '05 - Best and transfer 5%'
Start-Process Parser -Wait
cd ..
cd '06 - Best, no transfer'
Start-Process Parser -Wait
cd ..

New-Item -Name "Data" -ItemType "directory"

Move-Item -Path '01 - Kill parents and transfer 10%/Table.txt' -Destination 'Data/01 - Kill parents and transfer 10%.txt'
Move-Item -Path '02 - Kill parents and transfer 5%/Table.txt' -Destination 'Data/02 - Kill parents and transfer 5%.txt'
Move-Item -Path '03 - Kill parents, no transfer/Table.txt' -Destination 'Data/03 - Kill parents, no transfer.txt'
Move-Item -Path '04 - Best and transfer 10%/Table.txt' -Destination 'Data/04 - Best and transfer 10%.txt'
Move-Item -Path '05 - Best and transfer 5%/Table.txt' -Destination 'Data/05 - Best and transfer 5%.txt'
Move-Item -Path '06 - Best, no transfer/Table.txt' -Destination 'Data/06 - Best, no transfer.txt'
echo "Done!"

echo "Removing auxiliary files..."
Remove-Item '01 - Kill parents and transfer 10%/GA.exe'
Remove-Item '02 - Kill parents and transfer 5%/GA.exe'
Remove-Item '03 - Kill parents, no transfer/GA.exe'
Remove-Item '04 - Best and transfer 10%/GA.exe'
Remove-Item '05 - Best and transfer 5%/GA.exe'
Remove-Item '06 - Best, no transfer/GA.exe'

Remove-Item '01 - Kill parents and transfer 10%/Parser.exe'
Remove-Item '02 - Kill parents and transfer 5%/Parser.exe'
Remove-Item '03 - Kill parents, no transfer/Parser.exe'
Remove-Item '04 - Best and transfer 10%/Parser.exe'
Remove-Item '05 - Best and transfer 5%/Parser.exe'
Remove-Item '06 - Best, no transfer/Parser.exe'

Remove-Item '01 - Kill parents and transfer 10%/Input.txt'
Remove-Item '02 - Kill parents and transfer 5%/Input.txt'
Remove-Item '03 - Kill parents, no transfer/Input.txt'
Remove-Item '04 - Best and transfer 10%/Input.txt'
Remove-Item '05 - Best and transfer 5%/Input.txt'
Remove-Item '06 - Best, no transfer/Input.txt'

Remove-Item '01 - Kill parents and transfer 10%/Input_VC_IS.txt'
Remove-Item '02 - Kill parents and transfer 5%/Input_VC_IS.txt'
Remove-Item '03 - Kill parents, no transfer/Input_VC_IS.txt'
Remove-Item '04 - Best and transfer 10%/Input_VC_IS.txt'
Remove-Item '05 - Best and transfer 5%/Input_VC_IS.txt'
Remove-Item '06 - Best, no transfer/Input_VC_IS.txt'

cd ..
Rename-Item '02-Pop(100)' '02-Pop(100)+'
echo "Done!"



echo "Start GA for population of size 60"
cd '03-Pop(60)'

cd '01 - Kill parents and transfer 10%'
Start-Process GA
cd ..
cd '02 - Kill parents and transfer 5%'
Start-Process GA
cd ..
cd '03 - Kill parents, no transfer'
Start-Process GA
cd ..
cd '04 - Best and transfer 10%'
Start-Process GA
cd ..
cd '05 - Best and transfer 5%'
Start-Process GA
cd ..
cd '06 - Best, no transfer'
Start-Process GA
cd ..

echo "Running..."
$p = get-process GA
Wait-Process -Id $p.id
echo "Done!"

echo "Parsers are working..."
cd '01 - Kill parents and transfer 10%'
Start-Process Parser -Wait
cd ..
cd '02 - Kill parents and transfer 5%'
Start-Process Parser -Wait
cd ..
cd '03 - Kill parents, no transfer'
Start-Process Parser -Wait
cd ..
cd '04 - Best and transfer 10%'
Start-Process Parser -Wait
cd ..
cd '05 - Best and transfer 5%'
Start-Process Parser -Wait
cd ..
cd '06 - Best, no transfer'
Start-Process Parser -Wait
cd ..

New-Item -Name "Data" -ItemType "directory"

Move-Item -Path '01 - Kill parents and transfer 10%/Table.txt' -Destination 'Data/01 - Kill parents and transfer 10%.txt'
Move-Item -Path '02 - Kill parents and transfer 5%/Table.txt' -Destination 'Data/02 - Kill parents and transfer 5%.txt'
Move-Item -Path '03 - Kill parents, no transfer/Table.txt' -Destination 'Data/03 - Kill parents, no transfer.txt'
Move-Item -Path '04 - Best and transfer 10%/Table.txt' -Destination 'Data/04 - Best and transfer 10%.txt'
Move-Item -Path '05 - Best and transfer 5%/Table.txt' -Destination 'Data/05 - Best and transfer 5%.txt'
Move-Item -Path '06 - Best, no transfer/Table.txt' -Destination 'Data/06 - Best, no transfer.txt'
echo "Done!"

echo "Removing auxiliary files..."
Remove-Item '01 - Kill parents and transfer 10%/GA.exe'
Remove-Item '02 - Kill parents and transfer 5%/GA.exe'
Remove-Item '03 - Kill parents, no transfer/GA.exe'
Remove-Item '04 - Best and transfer 10%/GA.exe'
Remove-Item '05 - Best and transfer 5%/GA.exe'
Remove-Item '06 - Best, no transfer/GA.exe'

Remove-Item '01 - Kill parents and transfer 10%/Parser.exe'
Remove-Item '02 - Kill parents and transfer 5%/Parser.exe'
Remove-Item '03 - Kill parents, no transfer/Parser.exe'
Remove-Item '04 - Best and transfer 10%/Parser.exe'
Remove-Item '05 - Best and transfer 5%/Parser.exe'
Remove-Item '06 - Best, no transfer/Parser.exe'

Remove-Item '01 - Kill parents and transfer 10%/Input.txt'
Remove-Item '02 - Kill parents and transfer 5%/Input.txt'
Remove-Item '03 - Kill parents, no transfer/Input.txt'
Remove-Item '04 - Best and transfer 10%/Input.txt'
Remove-Item '05 - Best and transfer 5%/Input.txt'
Remove-Item '06 - Best, no transfer/Input.txt'

Remove-Item '01 - Kill parents and transfer 10%/Input_VC_IS.txt'
Remove-Item '02 - Kill parents and transfer 5%/Input_VC_IS.txt'
Remove-Item '03 - Kill parents, no transfer/Input_VC_IS.txt'
Remove-Item '04 - Best and transfer 10%/Input_VC_IS.txt'
Remove-Item '05 - Best and transfer 5%/Input_VC_IS.txt'
Remove-Item '06 - Best, no transfer/Input_VC_IS.txt'

cd ..
Rename-Item '03-Pop(60)' '03-Pop(60)+'
echo "Done!"



echo "Finalization..."
Remove-Item 'GA.exe'
Remove-Item 'Parser.exe'
Remove-Item 'Input.txt'
Remove-Item 'Input_VC_IS.txt'
Remove-Item 'PopulationLevelScript.ps1'

echo "Done!"